# Memory Bank Automation Scripts Directory

## Overview

This directory contains automation scripts for the Memory Bank Synchronization System. These scripts provide Git integration, workflow monitoring, and automated synchronization to ensure AI assistants always have access to current project context.

## Directory Structure

```
automation/
├── README.md                    # This documentation file
├── enhanced-automation.md       # Main automation setup script
├── automation-status.md         # Status dashboard for automation components
├── workflow-watcher.md          # Real-time workflow file monitor
├── setup-automation.md          # Legacy automation setup (deprecated)
├── monitor-sync.md             # Cron job sync trigger (generated)
├── rotate-logs.md              # Log rotation utility (generated)
└── logs/                       # Automation-specific logs
    ├── automation-status.log   # Status check history
    └── ...                     # Other automation logs
```

## Scripts Overview

### Core Scripts

#### `enhanced-automation.md`
**Purpose:** Complete automation system setup and configuration
**Usage:** `bash docs/scripts/automation/enhanced-automation.md`
**Functionality:**
- Sets up Git hooks (pre-commit validation, post-commit sync)
- Configures background monitoring service
- Creates workflow file watcher
- Sets up VS Code integration
- Generates all necessary automation components

**Generated Files:**
- `.git/hooks/pre-commit` - Validation before commits
- `.git/hooks/post-commit-sync` - Sync after commits
- `docs/scripts/monitoring/background-monitor.md` - Monitor daemon
- `docs/scripts/monitoring/monitor-control.md` - Service control
- `docs/scripts/automation/workflow-watcher.md` - File watcher
- `.vscode/tasks.json` - VS Code integration

#### `automation-status.md`
**Purpose:** Real-time status dashboard for all automation components
**Usage:** `bash docs/scripts/automation/automation-status.md`
**Output:**
- Git hooks status (active/inactive)
- Background monitor status (running/stopped with PID)
- Workflow watcher status (active/inactive)
- VS Code integration status
- Quick command reference

**Dependencies:** None (read-only status display)

### Monitoring Scripts

#### `workflow-watcher.md`
**Purpose:** Real-time monitoring of workflow_state.md for changes
**Usage:** `bash docs/scripts/automation/workflow-watcher.md &` (background)
**Functionality:**
- Monitors workflow file every 10 seconds
- Triggers immediate sync on file changes
- Provides real-time synchronization
- Cross-platform compatible (macOS/Linux)

**Process Management:** Runs as background process, PID tracked separately

### Legacy Scripts

#### `setup-automation.md` (Deprecated)
**Status:** Superseded by `enhanced-automation.md`
**Purpose:** Basic automation setup (cron-based)
**Note:** Use `enhanced-automation.md` for new installations

## Generated Files Documentation

### Git Hook Files
**Location:** `.git/hooks/`
**Purpose:** Integrate automation with Git workflow

#### `pre-commit`
- **Generated by:** `enhanced-automation.md`
- **Purpose:** Validates memory bank sync before allowing commits
- **Trigger:** Automatic on `git commit`
- **Failure behavior:** Blocks commit if validation fails
- **Log output:** Console warnings (non-blocking)

#### `post-commit-sync`
- **Generated by:** `enhanced-automation.md`
- **Purpose:** Automatically syncs memory bank after successful commits
- **Trigger:** Automatic after `git commit`
- **Failure behavior:** Logs error but doesn't block commit
- **Integration:** Appends to existing post-commit hook

### VS Code Integration Files
**Location:** `.vscode/`
**Purpose:** Provide one-click sync from VS Code interface

#### `tasks.json`
- **Generated by:** `enhanced-automation.md`
- **Purpose:** VS Code task configuration for memory bank sync
- **Usage:** Ctrl+Shift+P → "Tasks: Run Task" → "Sync Memory Bank"
- **Configuration:**
  ```json
  {
    "label": "Sync Memory Bank",
    "command": "bash",
    "args": ["docs/scripts/sync-engine.md"],
    "group": "build"
  }
  ```

### Log Files
**Location:** `docs/scripts/automation/logs/`
**Purpose:** Track automation system activity and debugging

#### `automation-status.log`
- **Generated by:** `automation-status.md`
- **Format:** `TIMESTAMP: Automation status checked - STATUS_DETAILS`
- **Rotation:** Manual (grows slowly)
- **Contents:** History of status checks with monitor PID information

## Setup Instructions

### Initial Setup
```bash
# Run enhanced automation setup
cd docs/scripts
bash automation/enhanced-automation.md
```

### Verification
```bash
# Check automation status
bash automation/automation-status.md

# Expected output:
# ✅ VS Code sync task configured
# (Other components ready to start)
```

### Starting Services
```bash
# Start background monitor
bash monitoring/monitor-control.md start

# Start workflow watcher (optional, for real-time sync)
bash automation/workflow-watcher.md &
```

## Usage Examples

### Daily Development Workflow
```bash
# Status check
bash docs/scripts/automation/automation-status.md

# Manual sync (if needed)
bash docs/scripts/sync-engine.md

# VS Code sync (Ctrl+Shift+P → Tasks: Run Task → Sync Memory Bank)
```

### Service Management
```bash
# Monitor control
bash docs/scripts/monitoring/monitor-control.md start
bash docs/scripts/monitoring/monitor-control.md status
bash docs/scripts/monitoring/monitor-control.md stop

# Workflow watching
bash docs/scripts/automation/workflow-watcher.md &
kill %1  # Stop background watcher
```

## Dependencies

### Required Tools
- **Bash:** Shell script execution
- **Git:** Version control and hooks
- **VS Code:** IDE integration (optional but recommended)

### Optional Tools
- **jq:** JSON parsing for metadata (fallback to basic parsing)
- **nohup:** Detached process execution
- **ps/kill:** Process management

## Error Handling

### Common Issues

#### Git Hooks Not Working
```bash
# Check hook permissions
ls -la .git/hooks/pre-commit

# Make executable
chmod +x .git/hooks/pre-commit
```

#### Background Monitor Not Starting
```bash
# Check for existing PID file
ls -la docs/scripts/monitoring/monitor.pid

# Clean up stale PID
rm docs/scripts/monitoring/monitor.pid
```

#### VS Code Tasks Not Available
```bash
# Verify tasks.json exists
cat .vscode/tasks.json

# Reload VS Code window
Ctrl+Shift+P → "Developer: Reload Window"
```

### Troubleshooting Commands
```bash
# Check all automation status
bash docs/scripts/automation/automation-status.md

# View recent logs
tail -20 docs/scripts/automation/logs/automation-status.log

# Test sync manually
bash docs/scripts/sync-engine.md

# Validate system
bash docs/scripts/validation/sync-validator.md
```

## Performance Characteristics

### Resource Usage
- **Memory:** < 10MB per background process
- **CPU:** < 1% during normal monitoring
- **Disk:** Minimal logging (recommend monthly cleanup)
- **Network:** Only during sync operations

### Timing
- **Git hooks:** < 5 seconds execution
- **Status checks:** < 2 seconds
- **Background monitoring:** 5-minute check cycles
- **Workflow watching:** 10-second file checks

## Maintenance

### Regular Tasks
```bash
# Weekly: Check automation status
bash docs/scripts/automation/automation-status.md

# Monthly: Clean up old logs
find docs/scripts/automation/logs -name "*.log" -mtime +30 -delete

# After system updates: Restart services
bash docs/scripts/monitoring/monitor-control.md restart
```

### Monitoring
- Check `automation-status.log` for unusual activity
- Monitor background process resource usage
- Verify Git hooks execute correctly
- Test VS Code integration periodically

## Integration Points

### With Other Scripts
- **sync-engine.md:** Called by automation for synchronization
- **sync-validator.md:** Called by Git hooks and monitoring
- **monitor-control.md:** Manages background services
- **sync-dashboard.md:** Provides system-wide status

### With Development Workflow
- **Git Integration:** Automatic validation and sync
- **VS Code Integration:** One-click sync from IDE
- **Background Monitoring:** Continuous health checks
- **Real-time Updates:** Immediate sync on workflow changes

## Security Considerations

### File Permissions
- Git hooks run with user permissions
- Background processes inherit user context
- Log files contain operational data only

### Data Handling
- No sensitive information in logs
- Metadata files contain timestamps and version info
- All operations are read-only from source data

## Future Enhancements

### Planned Features
- Webhook integration for remote triggering
- Slack/Discord notifications for sync failures
- Advanced scheduling options
- Performance metrics collection
- Multi-user collaboration support

### Extension Points
- Custom validation rules
- Additional Git hook types
- Alternative IDE integrations
- Container-specific optimizations

---

## Quick Reference

```bash
# Setup
bash docs/scripts/automation/enhanced-automation.md

# Status
bash docs/scripts/automation/automation-status.md

# Control
bash docs/scripts/monitoring/monitor-control.md {start|stop|status|restart}

# Manual operations
bash docs/scripts/sync-engine.md                    # Sync now
bash docs/scripts/validation/sync-validator.md      # Validate
bash docs/scripts/monitoring/sync-dashboard.md      # Full status
```

For issues or questions, check the logs in `docs/scripts/automation/logs/` or run the status dashboard for diagnostic information.